import{i as U,S as q,I as $}from"./vendor.63a8cbfa.js";const M=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const d of t.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function l(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(e){if(e.ep)return;e.ep=!0;const t=l(e);fetch(e.href,t)}};M();async function R(o){const l=await(await fetch(o)).arrayBuffer();return new Uint8Array(l)}async function C(){try{let x=function(){window.requestAnimationFrame(async()=>{console.time("frame"),await F(),console.timeEnd("frame"),x()})};const o=fetch("assets/squeeze-labels.txt").then(c=>c.text()),[r,l,a]=await Promise.all([R("assets/opt-squeeze.onnx"),U(),o]);console.log("Initialized",{modelBytes:r,initResult:l,Session:q,labelsResult:a});const e=224,t=224,d=await q.fromBytes(r),g=a.split(/\n/g);console.log({labelsList:g});const y=document.getElementById("player"),E={video:!0},z=await navigator.mediaDevices.getUserMedia(E);y.srcObject=z;const s=document.createElement("canvas");s.width=e,s.height=t;const p=s.getContext("2d",{willReadFrequently:!0});let h=0,w=0;async function F(){try{p.drawImage(y,0,0,s.width,s.height);const c=p.getImageData(0,0,s.width,s.height),I=new Float32Array(224*224*3),L=3,v=4;let T=[.485,.456,.406],_=[.229,.224,.225];for(let n=0;n<L;n++)for(let i=0;i<t;i++)for(let u=0;u<e;u++){const A=c.data[i*e*v+u*v+n]/255;I[n*(e*t)+i*e+u]=(A-T[n])/_[n]}const f=new $;f.insert("data",I);const N=performance.now(),O=await d.run(f),S=performance.now()-N;h++,w+=S,f.free();const b=O.get("squeezenet0_flatten0_reshape0");let m=-1,B=-1;for(let n=0;n<b.length;n++){const i=b[n];i>m&&(m=i,B=n)}document.getElementById("log").innerText=`${g[B]} (${m})`;const P=w/h;document.getElementById("perf").innerText=`Inference time: ${P.toFixed(2)}ms, at most ${Math.floor(1e3/P)} fps`}catch(c){document.getElementById("log").innerText="No GPU device found",console.error(c,c.toString())}}x()}catch(o){document.getElementById("log").innerText="No GPU device found",console.error(o,o.toString())}}C();
