import{i as M,S as P,I as N}from"./vendor.63a8cbfa.js";const R=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const u of t.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function l(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(e){if(e.ep)return;e.ep=!0;const t=l(e);fetch(e.href,t)}};R();async function C(o){const l=await(await fetch(o)).arrayBuffer();return new Uint8Array(l)}async function D(){try{let x=function(){window.requestAnimationFrame(async()=>{console.time("frame"),await F(),console.timeEnd("frame"),x()})};const o=fetch("assets/squeeze-labels.txt").then(c=>c.text()),[r,l,a]=await Promise.all([C("assets/opt-squeeze.onnx"),M(),o]);console.log("Initialized",{modelBytes:r,initResult:l,Session:P,labelsResult:a});const e=224,t=224,u=await P.fromBytes(r),g=a.split(/\n/g);console.log({labelsList:g});const y=document.getElementById("player"),z={video:!0},E=await navigator.mediaDevices.getUserMedia(z);y.srcObject=E;const s=document.createElement("canvas");s.width=e,s.height=t;const p=s.getContext("2d",{willReadFrequently:!0});let h=0,w=0;async function F(){try{p.drawImage(y,0,0,s.width,s.height);const c=p.getImageData(0,0,s.width,s.height),b=new Float32Array(224*224*3),L=3,I=4;let _=[.485,.456,.406],O=[.229,.224,.225];for(let n=0;n<L;n++)for(let i=0;i<t;i++)for(let f=0;f<e;f++){const $=c.data[i*e*I+f*I+n]/255;b[n*(e*t)+i*e+f]=($-_[n])/O[n]}const d=new N;d.insert("data",b);const S=performance.now(),A=await u.run(d),T=performance.now()-S;h++,w+=T,d.free();const v=A.get("squeezenet0_flatten0_reshape0");let m=-1,q=-1;for(let n=0;n<v.length;n++){const i=v[n];i>m&&(m=i,q=n)}document.getElementById("log").innerText=`${g[q]} (${m})`;const B=w/h;document.getElementById("perf").innerText=`Inference time: ${B.toFixed(2)}ms, at most ${Math.floor(1e3/B)} fps`}catch(c){console.error(c,c.toString())}}x()}catch(o){console.error(o,o.toString())}}D();
